<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Object Oriented Interface &#8212; hn2016_falwa 0.3.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Basis Functions" href="Basis Functions.html" />
    <link rel="prev" title="hn2016_falwa: Finite-amplitude local wave activity" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-oopinterface">
<span id="object-oriented-interface"></span><h1>Object Oriented Interface<a class="headerlink" href="#module-oopinterface" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="oopinterface.BarotropicField">
<em class="property">class </em><code class="descclassname">oopinterface.</code><code class="descname">BarotropicField</code><span class="sig-paren">(</span><em>xlon</em>, <em>ylat</em>, <em>pv_field</em>, <em>area=None</em>, <em>dphi=None</em>, <em>n_partitions=None</em>, <em>planet_radius=6378000.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/oopinterface.html#BarotropicField"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oopinterface.BarotropicField" title="Permalink to this definition">¶</a></dt>
<dd><p>An object that deals with barotropic (2D) wind and/or PV fields</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xlon</strong> (<em>sequence of array_like</em>) &#8211; Longitude array in degree with dimension <em>nlon</em>.</li>
<li><strong>ylat</strong> (<em>sequence of array_like</em>) &#8211; Latitutde array in degree, monotonically increasing with dimension <em>nlat</em></li>
<li><strong>area</strong> (<em>sequence of array_like</em>) &#8211; Differential area at each lon-lat grid points with dimension (nlat,nlon). If &#8216;area=None&#8217;: it will be initiated as area of uniform grid (in degree) on a spherical surface.</li>
<li><strong>dphi</strong> (<em>sequence of array_like</em>) &#8211; Differential length element along the lat grid with dimension nlat.</li>
<li><strong>pv_field</strong> (<em>sequence of array_like</em>) &#8211; Absolute vorticity field with dimension [nlat x nlon]. If &#8216;pv_field=None&#8217;: pv_field is expected to be computed with u,v,t field.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">an instance of the object BarotropicField</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">barofield1</span> <span class="o">=</span> <span class="n">BarotropicField</span><span class="p">(</span><span class="n">xlon</span><span class="p">,</span> <span class="n">ylat</span><span class="p">,</span> <span class="n">pv_field</span><span class="o">=</span><span class="n">abs_vorticity</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="oopinterface.BarotropicField.equivalent_latitudes">
<code class="descname">equivalent_latitudes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/oopinterface.html#BarotropicField.equivalent_latitudes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oopinterface.BarotropicField.equivalent_latitudes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute equivalent latitude with the <em>pv_field</em> stored in the object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">an numpy array with dimension (nlat) of equivalent latitude array.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">barofield1</span> <span class="o">=</span> <span class="n">BarotropicField</span><span class="p">(</span><span class="n">xlon</span><span class="p">,</span> <span class="n">ylat</span><span class="p">,</span> <span class="n">pv_field</span><span class="o">=</span><span class="n">abs_vorticity</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eqv_lat</span> <span class="o">=</span> <span class="n">barofield1</span><span class="o">.</span><span class="n">equivalent_latitudes</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="oopinterface.BarotropicField.lwa">
<code class="descname">lwa</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/oopinterface.html#BarotropicField.lwa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oopinterface.BarotropicField.lwa" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the finite-amplitude local wave activity based on the <em>equivalent_latitudes</em> and the <em>pv_field</em> stored in the object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">an 2-D numpy array with dimension (nlat,nlon) of local wave activity values.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">barofield1</span> <span class="o">=</span> <span class="n">BarotropicField</span><span class="p">(</span><span class="n">xlon</span><span class="p">,</span> <span class="n">ylat</span><span class="p">,</span> <span class="n">pv_field</span><span class="o">=</span><span class="n">abs_vorticity</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eqv_lat</span> <span class="o">=</span> <span class="n">barofield1</span><span class="o">.</span><span class="n">equivalent_latitudes</span><span class="p">()</span> <span class="c1"># This line is optional</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lwa</span> <span class="o">=</span> <span class="n">barofield1</span><span class="o">.</span><span class="n">lwa</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="oopinterface.QGField">
<em class="property">class </em><code class="descclassname">oopinterface.</code><code class="descname">QGField</code><span class="sig-paren">(</span><em>xlon</em>, <em>ylat</em>, <em>plev</em>, <em>u_field</em>, <em>v_field</em>, <em>t_field</em>, <em>kmax=49</em>, <em>maxit=100000</em>, <em>dz=1000.0</em>, <em>prefactor=6500.0</em>, <em>npart=None</em>, <em>tol=1e-05</em>, <em>rjac=0.95</em>, <em>scale_height=7000.0</em>, <em>cp=1004.0</em>, <em>dry_gas_constant=287.0</em>, <em>omega=7.29e-05</em>, <em>planet_radius=6378000.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/oopinterface.html#QGField"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oopinterface.QGField" title="Permalink to this definition">¶</a></dt>
<dd><p>Local wave activity and flux analysis in quasi-geostrophic framework
that can be used to reproduce the results in:
Nakamura and Huang, Atmospheric Blocking as a Traffic Jam in the Jet Stream, Science (2018)</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0.0.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>xlon</strong> (<em>numpy.array</em>) &#8211; Array of longitude (in degree) of size nlon.</li>
<li><strong>ylat</strong> (<em>numpy.array</em>) &#8211; Array of latitude (in degree) of size nlat.</li>
<li><strong>plev</strong> (<em>numpy.</em>) &#8211; Array of pressure level (in hPa) of size nlev.</li>
<li><strong>u_field</strong> (<em>numpy.ndarray</em>) &#8211; Three-dimensional array of zonal wind field (in m/s) of dimension [nlev, nlat, nlon].</li>
<li><strong>v_field</strong> (<em>numpy.ndarray</em>) &#8211; Three-dimensional array of meridional wind field (in m/s) of dimension [nlev, nlat, nlon].</li>
<li><strong>t_field</strong> (<em>numpy.ndarray</em>) &#8211; Three-dimensional array of temperature field (in K) of dimension [nlev, nlat, nlon].</li>
<li><strong>kmax</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Dimension of uniform pseudoheight grids used for interpolation.</li>
<li><strong>maxit</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Number of iteration by the Successive over-relaxation (SOR) solver to compute the reference states.</li>
<li><strong>dz</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Size of uniform pseudoheight grids (in meters).</li>
<li><strong>prefactor</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Vertical air density summed over height.</li>
<li><strong>npart</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Number of partitions used to compute equivalent latitude.
If not initialized, it will be set to nlat.</li>
<li><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Tolerance that defines the convergence of solution in SOR solver.</li>
<li><strong>rjac</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Spectral radius of the Jacobi iteration in the SOR solver.</li>
<li><strong>scale_height</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Scale height of the atmosphere in meters. Default = 7000.</li>
<li><strong>cp</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Heat capacity of dry air in J/kg-K. Default = 1004.</li>
<li><strong>dry_gas_constant</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Gas constant for dry air in J/kg-K. Default = 287.</li>
<li><strong>omega</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Rotation rate of the earth in 1/s. Default = 7.29e-5.</li>
<li><strong>planet_radius</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Radius of the planet in meters.
Default = 6.378e+6 (Earth&#8217;s radius).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test_object</span> <span class="o">=</span> <span class="n">QGField</span><span class="p">(</span><span class="n">xlon</span><span class="p">,</span> <span class="n">ylat</span><span class="p">,</span> <span class="n">plev</span><span class="p">,</span>
<span class="go">                         u_field, v_field, t_field)</span>
</pre></div>
</div>
<dl class="method">
<dt id="oopinterface.QGField.compute_local_fluxes">
<code class="descname">compute_local_fluxes</code><span class="sig-paren">(</span><em>northern_hemisphere_results_only=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/oopinterface.html#QGField.compute_local_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oopinterface.QGField.compute_local_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute barotropic components of local wave activity and flux terms in eqs.(2)
and (3) in Nakamura and Huang (Science, 2018).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>northern_hemisphere_results_only</strong> (<em>bool</em>) &#8211; If true, arrays of size [kmax, nlat//2] will be returned. Otherwise, arrays of size [kmax, nlat] will be returned. This parameter is present since the current version (v0.3.1) of the package only return analysis in the northern hemisphere. Default: True.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>qgpv</strong> (<em>numpy.ndarray</em>) &#8211; Three-dimension array of quasi-geostrophic potential vorticity (QGPV) with dimension = [kmax, nlat, nlon]</li>
<li><strong>interpolated_u</strong> (<em>numpy.ndarray</em>) &#8211; Three-dimension array of interpolated zonal wind with dimension = [kmax, nlat, nlon]</li>
<li><strong>interpolated_v</strong> (<em>numpy.ndarray</em>) &#8211; Three-dimension array of interpolated meridional wind with dimension = [kmax, nlat, nlon]</li>
<li><strong>interpolated_theta</strong> (<em>numpy.ndarray</em>) &#8211; Three-dimension array of interpolated potential temperature with dimension = [kmax, nlat, nlon]</li>
<li><strong>static_stability</strong> (<em>numpy.array</em>) &#8211; One-dimension array of interpolated static stability with dimension = kmax</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qgpv</span><span class="p">,</span> <span class="n">interpolated_u</span><span class="p">,</span> <span class="n">interpolated_v</span><span class="p">,</span>
<span class="go">    interpolated_theta, static_stability</span>
<span class="go">    = test_object.interpolate_fields()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="oopinterface.QGField.compute_reference_states">
<code class="descname">compute_reference_states</code><span class="sig-paren">(</span><em>northern_hemisphere_results_only=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/oopinterface.html#QGField.compute_reference_states"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oopinterface.QGField.compute_reference_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the local wave activity and reference states of QGPV, zonal wind and
potential temperature using a more stable inversion algorithm applied in
Nakamura and Huang (2018, Science). The equation to be invert is equation (22)
in supplementary materials of Huang and Nakamura (2017, GRL). In this version,
only values in the Northern Hemisphere is computed. Southern Hemispheric grid
points are filled with value 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>northern_hemisphere_results_only</strong> (<em>bool</em>) &#8211; If true, arrays of size [kmax, nlat//2] will be returned. Otherwise, arrays of size [kmax, nlat] will be returned. This parameter is present since the current version (v0.3.1) of the package only return analysis in the northern hemisphere. Default: True.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>adv_flux_f1</strong> (<em>numpy.ndarray</em>) &#8211; Two-dimension array of the second-order eddy term in zonal advective flux convergence,
i.e. F1 in equation 3 of NH18, with dimension = [nlat, nlon]</li>
<li><strong>adv_flux_f2</strong> (<em>numpy.ndarray</em>) &#8211; Two-dimension array of the third-order eddy term in zonal advective flux convergence,
i.e. F2 in equation 3 of NH18, with dimension = [nlat, nlon]</li>
<li><strong>adv_flux_f3</strong> (<em>numpy.ndarray</em>) &#8211; Two-dimension array of the remaining term in zonal advective flux convergence,
i.e. F3 in equation 3 of NH18, with dimension = [nlat, nlon]</li>
<li><strong>divergence_eddy_momentum_flux</strong> (<em>numpy.ndarray</em>) &#8211; Two-dimension array of the divergence of eddy momentum flux,
i.e. (II) in equation 2 of NH18, with dimension = [nlat, nlon]</li>
<li><strong>meridional_heat_flux</strong> (<em>numpy.ndarray</em>) &#8211; Two-dimension array of the low-level meridional heat flux,
i.e. (III) in equation 2 of NH18, with dimension = [nlat, nlon]</li>
<li><strong>lwa_baro</strong> (<em>np.ndarray</em>) &#8211; Two-dimension array of barotropic local wave activity (with cosine weighting).</li>
<li><strong>u_baro</strong> (<em>np.ndarray</em>) &#8211; Two-dimension array of barotropic zonal wind (without cosine weighting).</li>
<li><strong>lwa</strong> (<em>np.ndarray</em>) &#8211; Three-dimension array of barotropic local wave activity with
dimension = [kmax, nlon, nlat]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qref</span><span class="p">,</span> <span class="n">uref</span><span class="p">,</span> <span class="n">ptref</span>
<span class="go">        = test_object.compute_reference_states()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="oopinterface.QGField.interpolate_fields">
<code class="descname">interpolate_fields</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/oopinterface.html#QGField.interpolate_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oopinterface.QGField.interpolate_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate zonal wind, maridional wind, and potential temperature field onto the
uniform pseudoheight grids, and compute QGPV on the same grids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>qgpv</strong> (<em>numpy.ndarray</em>) &#8211; Three-dimension array of quasi-geostrophic potential vorticity (QGPV) with dimension = [kmax, nlat, nlon]</li>
<li><strong>interpolated_u</strong> (<em>numpy.ndarray</em>) &#8211; Three-dimension array of interpolated zonal wind with dimension = [kmax, nlat, nlon]</li>
<li><strong>interpolated_v</strong> (<em>numpy.ndarray</em>) &#8211; Three-dimension array of interpolated meridional wind with dimension = [kmax, nlat, nlon]</li>
<li><strong>interpolated_theta</strong> (<em>numpy.ndarray</em>) &#8211; Three-dimension array of interpolated potential temperature with dimension = [kmax, nlat, nlon]</li>
<li><strong>static_stability</strong> (<em>numpy.array</em>) &#8211; One-dimension array of interpolated static stability with dimension = kmax</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adv_flux_f1</span><span class="p">,</span> <span class="n">adv_flux_f2</span><span class="p">,</span> <span class="n">adv_flux_f3</span><span class="p">,</span>
<span class="go">    divergence_eddy_momentum_flux, meridional_heat_flux,</span>
<span class="go">    lwa_baro, u_baro, lwa = test_object.compute_local_fluxes()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Object Oriented Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Basis Functions.html">Basis Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Wrapper Functions.html">Wrapper Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Utility Functions.html">Utility Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Beta-version Functions.html">Beta-version Functions</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">hn2016_falwa: Finite-amplitude local wave activity</a></li>
      <li>Next: <a href="Basis Functions.html" title="next chapter">Basis Functions</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Object Oriented Interface.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Clare S. Y. Huang.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/Object Oriented Interface.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>